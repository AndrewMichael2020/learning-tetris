<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reinforcement Learning Tetris</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Discrete Combinatorial vs Reinforcement Learning Algorithms: Who Plays This "Tetris" Better?</h1>
            <p>Reinforced Learning vs CEM, Nurse Dictator, Nurse Gossip, Coffee Break, and Night Shift Ant March</p>
        </header>
        
        <div class="main-content">
            <!-- Game Board Section -->
            <div class="game-section">
                <h2>Game Board</h2>
                <div class="canvas-container">
                    <canvas id="gameCanvas" width="400" height="800"></canvas>
                </div>
                <div class="game-controls">
                    <button id="streamBtn" class="btn btn-primary">Stream Agent</button>
                    <button id="playOnceBtn" class="btn btn-secondary">Play Once</button>
                    <button id="playMultipleBtn" class="btn btn-info">Play Multiple</button>
                    <button id="quickTrainBtn" class="btn btn-warning" disabled>Quick Train</button>
                </div>
                
                <!-- Button Instructions -->
                <div class="button-instructions">
                    <h3>How to Use</h3>
                    <div class="instruction-list">
                        <div class="instruction-item">
                            <span class="instruction-icon btn-primary-icon">▶</span>
                            <div class="instruction-text">
                                <strong>Stream Agent:</strong> Watch the AI play continuously in real-time with live updates
                            </div>
                        </div>
                        <div class="instruction-item">
                            <span class="instruction-icon btn-secondary-icon">●</span>
                            <div class="instruction-text">
                                <strong>Play Once:</strong> Run a single episode and watch the AI play step-by-step with live updates
                            </div>
                        </div>
                        <div class="instruction-item">
                            <span class="instruction-icon btn-info-icon">▶▶</span>
                            <div class="instruction-text">
                                <strong>Play Multiple:</strong> Run multiple episodes using the Episodes setting and view real-time progress and statistics
                            </div>
                        </div>
                        <div class="instruction-item">
                            <span class="instruction-icon btn-warning-icon">⚡</span>
                            <div class="instruction-text">
                                <strong>Quick Train:</strong> Train a new AI agent (available when training is enabled)
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Stats Section -->
            <div class="stats-section">
                <h2>Statistics</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <label>Score:</label>
                        <span id="currentScore">0</span>
                    </div>
                    <div class="stat-item">
                        <label>Lines:</label>
                        <span id="currentLines">0</span>
                    </div>
                    <div class="stat-item">
                        <label>Steps:</label>
                        <span id="currentSteps">0</span>
                    </div>
                    <div class="stat-item">
                        <label>Status:</label>
                        <span id="gameStatus">Ready</span>
                    </div>
                </div>
                
                <h3>Episode Results</h3>
                <div class="results">
                    <div class="result-row">
                        <label>Episodes:</label>
                        <span id="totalEpisodes">0</span>
                    </div>
                    <div class="result-row">
                        <label>Avg Score:</label>
                        <span id="avgScore">0</span>
                    </div>
                    <div class="result-row">
                        <label>Total Lines:</label>
                        <span id="totalLines">0</span>
                    </div>
                    <div class="result-row">
                        <label>Best Score:</label>
                        <span id="bestScore">0</span>
                    </div>
                    <div class="result-row">
                        <label>Max Score:</label>
                        <span id="maxScore">999999</span>
                    </div>
                    <button id="clearResultsBtn" class="btn btn-secondary" style="margin-top: 10px; width: 100%;">Clear Results</button>
                </div>
                
                <!-- Performance Benchmarks -->
                <div class="performance-benchmarks">
                    <h3>Performance Benchmarks</h3>
                    <div class="benchmark-list">
                        <div class="benchmark-item beginner">
                            <strong>Beginner AI:</strong> 100-700 points, 2-3 lines per game
                        </div>
                        <div class="benchmark-item intermediate">
                            <strong>Intermediate AI:</strong> 700-1300 points, 4-6 lines per game
                        </div>
                        <div class="benchmark-item advanced">
                            <strong>Advanced AI:</strong> 1300+ points, 7-10 lines per game
                        </div>
                        <div class="benchmark-item expert">
                            <strong>Expert AI:</strong> 2000+ points with consistent line clearing
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Controls Section -->
            <div class="controls-section">
                <h2>Controls</h2>
                
                <div class="control-group">
                    <h3>Play Settings</h3>
                    <div class="form-row">
                        <label for="episodes">Episodes:</label>
                        <input type="number" id="episodes" value="1" min="1" max="100">
                    </div>
                    <div class="form-row">
                        <label for="seed">Seed (optional):</label>
                        <input type="number" id="seed" placeholder="Random">
                    </div>
                    <div class="form-row">
                        <label for="algorithm">Algorithm:</label>
                        <select id="algorithm">
                            <option value="cem">CEM</option>
                            <option value="reinforce">REINFORCE</option>
                            <option value="greedy">Greedy (Nurse Dictator)</option>
                            <option value="tabu">Tabu Search (Nurse Gossip)</option>
                            <option value="anneal">Simulated Annealing (Coffee Break)</option>
                            <option value="aco">Ant Colony (Night Shift Ant March)</option>
                        </select>
                    </div>
                    
                    <!-- Algorithm-specific play controls -->
                    <div id="playGreedyControls" style="display: none;">
                        <h4>Greedy Parameters</h4>
                        <div class="form-row">
                            <label for="play_greedy_w_holes">Holes Weight:</label>
                            <input type="number" id="play_greedy_w_holes" value="0.8" step="0.1" min="0">
                        </div>
                        <div class="form-row">
                            <label for="play_greedy_w_max_height">Max Height Weight:</label>
                            <input type="number" id="play_greedy_w_max_height" value="0.4" step="0.1" min="0">
                        </div>
                        <div class="form-row">
                            <label for="play_greedy_w_bumpiness">Bumpiness Weight:</label>
                            <input type="number" id="play_greedy_w_bumpiness" value="0.3" step="0.1" min="0">
                        </div>
                    </div>
                    
                    <div id="playTabuControls" style="display: none;">
                        <h4>Tabu Search Parameters</h4>
                        <div class="form-row">
                            <label for="play_tabu_tenure">Tabu Tenure:</label>
                            <input type="number" id="play_tabu_tenure" value="7" min="3" max="15">
                        </div>
                        <div class="form-row">
                            <label for="play_tabu_neighborhood_k">Neighborhood Size:</label>
                            <input type="number" id="play_tabu_neighborhood_k" value="10" min="3" max="20">
                        </div>
                        <div class="form-row">
                            <label for="play_tabu_aspiration">Aspiration Criteria:</label>
                            <input type="checkbox" id="play_tabu_aspiration" checked>
                        </div>
                    </div>
                    
                    <div id="playAnnealControls" style="display: none;">
                        <h4>Simulated Annealing Parameters</h4>
                        <div class="form-row">
                            <label for="play_anneal_T0">Initial Temperature:</label>
                            <input type="number" id="play_anneal_T0" placeholder="Auto" step="0.1" min="0.1">
                        </div>
                        <div class="form-row">
                            <label for="play_anneal_alpha">Cooling Rate:</label>
                            <input type="number" id="play_anneal_alpha" value="0.99" step="0.01" min="0.5" max="0.999">
                        </div>
                    </div>
                    
                    <div id="playAcoControls" style="display: none;">
                        <h4>Ant Colony Parameters</h4>
                        <div class="form-row">
                            <label for="play_aco_alpha">Pheromone Influence (α):</label>
                            <input type="number" id="play_aco_alpha" value="1.0" step="0.1" min="0.1" max="5">
                        </div>
                        <div class="form-row">
                            <label for="play_aco_beta">Heuristic Influence (β):</label>
                            <input type="number" id="play_aco_beta" value="2.0" step="0.1" min="0.1" max="5">
                        </div>
                        <div class="form-row">
                            <label for="play_aco_ants">Number of Ants:</label>
                            <input type="number" id="play_aco_ants" value="20" min="5" max="50">
                        </div>
                    </div>
                </div>
                
                <div class="control-group" id="trainControls" style="display: none;">
                    <h3>Training Settings</h3>
                    <div class="form-row">
                        <label for="trainAlgo">Algorithm:</label>
                        <select id="trainAlgo">
                            <option value="cem">CEM</option>
                            <option value="reinforce">REINFORCE</option>
                            <option value="greedy">Greedy (Nurse Dictator)</option>
                            <option value="tabu">Tabu Search (Nurse Gossip)</option>
                            <option value="anneal">Simulated Annealing (Coffee Break)</option>
                            <option value="aco">Ant Colony (Night Shift Ant March)</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label for="trainSeed">Seed:</label>
                        <input type="number" id="trainSeed" value="42">
                    </div>
                    
                    <!-- CEM specific controls -->
                    <div id="cemControls">
                        <div class="form-row">
                            <label for="generations">Generations:</label>
                            <input type="number" id="generations" value="3" min="1" max="10">
                        </div>
                        <div class="form-row">
                            <label for="populationSize">Population Size:</label>
                            <input type="number" id="populationSize" value="20" min="10" max="50">
                        </div>
                    </div>
                    
                    <!-- REINFORCE specific controls -->
                    <div id="reinforceControls" style="display: none;">
                        <div class="form-row">
                            <label for="trainEpisodes">Episodes:</label>
                            <input type="number" id="trainEpisodes" value="200" min="50" max="500">
                        </div>
                        <div class="form-row">
                            <label for="learningRate">Learning Rate:</label>
                            <input type="number" id="learningRate" value="0.01" step="0.001" min="0.001" max="1">
                        </div>
                    </div>
                    
                    <!-- NEW ALGORITHM CONTROLS -->
                    
                    <!-- Greedy specific controls -->
                    <div id="greedyControls" style="display: none;">
                        <h4>Feature Weights</h4>
                        <div class="form-row">
                            <label for="greedy_w_holes">Holes Weight:</label>
                            <input type="number" id="greedy_w_holes" value="0.8" step="0.1" min="0">
                        </div>
                        <div class="form-row">
                            <label for="greedy_w_max_height">Max Height Weight:</label>
                            <input type="number" id="greedy_w_max_height" value="0.4" step="0.1" min="0">
                        </div>
                        <div class="form-row">
                            <label for="greedy_w_bumpiness">Bumpiness Weight:</label>
                            <input type="number" id="greedy_w_bumpiness" value="0.3" step="0.1" min="0">
                        </div>
                    </div>
                    
                    <!-- Tabu Search specific controls -->
                    <div id="tabuControls" style="display: none;">
                        <h4>Tabu Search Parameters</h4>
                        <div class="form-row">
                            <label for="tabu_tenure">Tabu Tenure:</label>
                            <input type="number" id="tabu_tenure" value="25" min="5" max="100">
                        </div>
                        <div class="form-row">
                            <label for="tabu_neighborhood_k">Neighborhood Size:</label>
                            <input type="number" id="tabu_neighborhood_k" value="10" min="3" max="20">
                        </div>
                        <div class="form-row">
                            <label for="tabu_aspiration">Aspiration Criteria:</label>
                            <input type="checkbox" id="tabu_aspiration" checked>
                        </div>
                        <h4>Feature Weights</h4>
                        <div class="form-row">
                            <label for="tabu_w_holes">Holes Weight:</label>
                            <input type="number" id="tabu_w_holes" value="0.8" step="0.1" min="0">
                        </div>
                        <div class="form-row">
                            <label for="tabu_w_max_height">Max Height Weight:</label>
                            <input type="number" id="tabu_w_max_height" value="0.4" step="0.1" min="0">
                        </div>
                    </div>
                    
                    <!-- Simulated Annealing specific controls -->
                    <div id="annealControls" style="display: none;">
                        <h4>Annealing Parameters</h4>
                        <div class="form-row">
                            <label for="anneal_T0">Initial Temperature:</label>
                            <input type="number" id="anneal_T0" placeholder="Auto" step="0.1" min="0.1">
                        </div>
                        <div class="form-row">
                            <label for="anneal_alpha">Cooling Rate:</label>
                            <input type="number" id="anneal_alpha" value="0.99" step="0.01" min="0.5" max="0.999">
                        </div>
                        <div class="form-row">
                            <label for="anneal_proposal_k">Proposal Neighborhood:</label>
                            <input type="number" id="anneal_proposal_k" value="10" min="3" max="20">
                        </div>
                        <h4>Feature Weights</h4>
                        <div class="form-row">
                            <label for="anneal_w_holes">Holes Weight:</label>
                            <input type="number" id="anneal_w_holes" value="0.8" step="0.1" min="0">
                        </div>
                        <div class="form-row">
                            <label for="anneal_w_max_height">Max Height Weight:</label>
                            <input type="number" id="anneal_w_max_height" value="0.4" step="0.1" min="0">
                        </div>
                    </div>
                    
                    <!-- Ant Colony Optimization specific controls -->
                    <div id="acoControls" style="display: none;">
                        <h4>ACO Parameters</h4>
                        <div class="form-row">
                            <label for="aco_alpha">Pheromone Influence (α):</label>
                            <input type="number" id="aco_alpha" value="1.0" step="0.1" min="0.1" max="5">
                        </div>
                        <div class="form-row">
                            <label for="aco_beta">Heuristic Influence (β):</label>
                            <input type="number" id="aco_beta" value="2.0" step="0.1" min="0.1" max="5">
                        </div>
                        <div class="form-row">
                            <label for="aco_rho">Evaporation Rate (ρ):</label>
                            <input type="number" id="aco_rho" value="0.10" step="0.01" min="0.01" max="0.5">
                        </div>
                        <div class="form-row">
                            <label for="aco_ants">Number of Ants:</label>
                            <input type="number" id="aco_ants" value="20" min="5" max="50">
                        </div>
                        <div class="form-row">
                            <label for="aco_elite">Elite Ants:</label>
                            <input type="number" id="aco_elite" value="1" min="1" max="10">
                        </div>
                        <h4>Feature Weights</h4>
                        <div class="form-row">
                            <label for="aco_w_holes">Holes Weight:</label>
                            <input type="number" id="aco_w_holes" value="0.8" step="0.1" min="0">
                        </div>
                        <div class="form-row">
                            <label for="aco_w_max_height">Max Height Weight:</label>
                            <input type="number" id="aco_w_max_height" value="0.4" step="0.1" min="0">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Log Section -->
        <div class="log-section">
            <h3>Activity Log</h3>
            <div id="activityLog" class="log-container">
                <div class="log-entry">Application started</div>
            </div>
        </div>
    </div>
    
    <script src="/static/app.js"></script>
</body>
</html>